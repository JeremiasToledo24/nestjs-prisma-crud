name: üöÄ PR de Staging a Main

# 1. ACTIVADOR
# Se ejecuta cada vez que haces un 'push' (sync) a la rama 'staging'.
on:
  push:
    branches:
      - staging

# 2. PERMISOS
# Necesitamos permisos para leer el contenido y escribir Pull Requests.
permissions:
  pull-requests: write
  contents: read

# 3. TRABAJO (JOB)
jobs:
  create_pr_to_main:
    runs-on: ubuntu-latest
    steps:
      - name: 1. Crear Pull Request de 'staging' a 'main'
        run: |
          gh pr create \
            --base main \
            --head staging \
            --title "ü§ñ [Auto-PR] Sincronizar staging -> main" \
            --body "Este PR fue creado autom√°ticamente por un push a 'staging'."
        env:
          # Usamos el token autom√°tico de GitHub para autenticar el comando
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        # MUY IMPORTANTE:
        # Si el PR ya existe o si no hay cambios, el comando 'gh pr create' falla.
        # Con 'continue-on-error: true', hacemos que el workflow
        # simplemente se detenga sin marcarlo como "fallido".
        continue-on-error: true
